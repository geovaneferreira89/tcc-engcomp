\chapter{Fundamentação Teórica}
\label{sec:Fund}

O capítulo de Fundamentação Teórica tem como objetivo apresentar os conceitos envolvidos no desenvolvimento do projeto. Inicialmente, serão abordados temas relativos ao coração humano e à geração do sinal de Eletrocardiografia (ECG), englobando as seções Fisiologia do Coração \ref{sec:Fisiologia}, Formação do Sinal de Eletrocardiografia \ref{sec:FormaSinal}, Exame de Eletrocardiografia \ref{sec:Exame}, Sistema de Derivações \ref{sec:SistemaDer} e Ondas, Segmentos e Intervalos \ref{sec:Ondas}. Em seguida, as seções Função Correlação \ref{sec:Correl} e Redes Neurais Artificiais \ref{sec:RNA} abordam a operação da correlação e redes neurais, respectivamente. A seção Avaliação de Sistemas Classificadores \ref{sec:AvaliaSis} trata assuntos relativos à análise dos resultados do sistema. E o capítulo é finalizado com  a seção de Considerações \ref{sec:Consid}.

\section{Fisiologia do Coração}
\label{sec:Fisiologia}

O coração humano possui paredes compostas por músculos cardíacos estriados, chamados de miocárdio, e forma quatro compartimentos: o átrio direito, o átrio esquerdo, o ventrículo direito e o ventrículo esquerdo.  A figura ~\ref{fig:heart} mostra o coração com indicações dos respectivos átrios e ventrículos \cite{MALMIVUO1995}.

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.6\textwidth]{./figs/heart.png} % <- formatos PNG, JPG e PDF
		\caption[Anatomia de um coração]{Anatomia de um coração}
	\fonte{\cite{MALMIVUO1995}}
	\label{fig:heart}
\end{figure}

O coração possui ainda quatro válvulas. Entre o átrio direito e o ventrículo direito se encontra a válvula tricúspide, e entre o átrio esquerdo e o ventrículo esquerdo fica a válvula mitral. A válvula pulmonar fica entre o ventrículo direito e a artéria pulmonar, enquanto a válvula aorta está no trato de saída do ventrículo esquerdo, e controla o fluxo para a aorta \cite{MALMIVUO1995}.

Para retornar da circulação sistêmica, o sangue chega ao átrio direito e dele segue pela válvula tricúspide para o ventrículo direito. Então o sangue é ejetado do ventrículo direito para os pulmões, pela válvula pulmonar. Dos pulmões, o sangue oxigenado retorna para o átrio esquerdo, e passa pela válvula mitral até o ventrículo esquerdo. Finalmente, é bombeado pela válvula aorta para a aorta e para a circulação sistêmica. A contração ventricular necessária para o esvaziamento do ventrículo é conhecida como sístole. O relaxamento ventricular é conhecido como diástole e é nessa fase que os ventrículos recebem sangue do átrio \cite{MALMIVUO1995}. 

A figura \ref{} mostra o diagrama de blocos do coração mostrando o sentido em que o sangue circula.

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.6\textwidth]{./figs/coracao.png} % <- formatos PNG, JPG e PDF
		\caption[Diagrama de blocos do coração]{Diagrama de blocos do coração}
	\fonte{Autoria própria}
	\label{fig:coracao}
\end{figure}

A fibra muscular que forma o coração é orientada em espiral. O fato das células musculares cardíacas permanecerem tangencialmente e radialmente, como mostra a figura ~\ref{fig:muscle}, e a resistência do músculo ser mais baixa em direção as fibras são importantes na área da eletrocardiografia, pois a atividade elétrica pode se propagar de uma célula para outra em qualquer direção. Como resultado disso, as formas de onda de ativação são bastante complexas \cite{MALMIVUO1995}.

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.6\textwidth]{./figs/muscle.png} % <- formatos PNG, JPG e PDF
		\caption[Fibras musculares cardíacas]{Fibras musculares cardíacas}
	\fonte{\cite{MALMIVUO1995}}
	\label{fig:muscle}
\end{figure}

\section{Formação do Sinal de Eletrocardiografia}
\label{sec:FormaSinal}

O músculo cardíaco, miocárdio, é composto por células geradoras de potencial elétricas denominadas cardiomiócitos. Durante o processo de diástole, o miocárdio está relaxado e não produz atividade elétrica. Suas células permanecem polarizadas na membrana com um potencial elétrico de aproximadamente -90 mV. No entanto, a contração ocasionada pela sístole reverte o potencial elétrico das células miocardiais, caracterizando a fase de despolarização \cite{GACEK2011}. 

Logo após a despolarização, ocorre a fase de repolarização, e o músculo retorna a seu estado de relaxamento anterior (diástole). Durante a repolarização, o músculo cardíaco é incapaz de ser estimulado, o que o protege de alguma eventual estimulação prematura \cite{GACEK2011}, evitando danos ao sistema cardíaco.

Estas mudanças no potencial elétrico durante os processos de despolarização e repolarização das fibras do miocárdio são registradas com a colocação de eletrodos posicionados na superfície do peito e nas derivações dos membros, e constituem os sinais de Eletrocardiografia (ECG). A forma de onda do ECG pode ser impressa em papel ou mostrada na tela do computador \cite{GACEK2011}.

\section{Exame de Eletrocardiografia}
\label{sec:Exame}

Dentre as vantagens dos exames de Eletrocardiografia (ECG), podem ser citadas seu baixo custo, facilidade de implementação, o fato de ser um procedimento não invasivo e a obtenção imediata dos resultados \cite{GACEK2011}.

Os exames de ECG podem auxiliar em diagnósticos cardiológicos tais como \cite{MALMIVUO1995}:

\begin{enumerate}
  \item Eixo elétrico do coração
  \item Monitoramento de frequência cardíaca
  \item Arritmias
  \begin{enumerate}
      \item Arritmias supraventriculares 
      \item Arritmias ventriculares
  \end{enumerate}
  \item Desordens na sequência de ativação
  \begin{enumerate}
      \item Defeitos na condução atrioventricular
      \item Bloqueio atrioventricular de primeiro grau
      \item Síndrome de Wolff-Parkinson-White 
  \end{enumerate} 
  \item Aumento da espessura das paredes ou do tamanho dos átrios e ventrículos 
  \begin{enumerate}
      \item Hipertrofia atrial
      \item Hipertrofia ventricular
  \end{enumerate}
  \item Isquemia e infarto do miocárdio
  \begin{enumerate}
      \item Isquemia
      \item Infarto 
  \end{enumerate}
  \item Efeito de drogas
  \item Desequilíbrio eletrolítico
  \begin{enumerate}
      \item Potássio
      \item Cálcio 
  \end{enumerate}
  \item Cardite
  \begin{enumerate}
      \item Pericardite
      \item Miocardite
  \end{enumerate}
  \item Monitoramento de marca-passo
\end{enumerate}

Os possíveis artefatos em sinais biomédicos são os instrumentais, como os de eletrodo e fisiológicos ou biológicos, que incluem os movimentos musculares, respiratórios entre outros \cite{ANGHINAH2006}.

\section{Sistema de Derivações}
\label{sec:SistemaDer}

O sistema de configuração mais comum em exames ambulatoriais de Eletrocardiografia (ECG) é o sistema 12 derivações, que consiste nas seguintes derivações \cite{MALMIVUO1995}:

\begin{itemize}
	\item Derivações dos membros (\textit{Limb leads}): I, II, III;	 
	\item Derivações aumentadas ou de Goldberger (\textit{Goldberger Augmented Leads}): aV\textsubscript{R}, {aV}\textsubscript{L}; %e aV\textsubscript{F} (ou V\textsubscript{R}, V\textsubscript{L} e V\textsubscript{F})
	\item Derivações Precordiais (\textit{Precordial leads}): V\textsubscript{1}, V\textsubscript{2}, V\textsubscript{3}, V\textsubscript{4}, V\textsubscript{5} e V\textsubscript{6}.
\end{itemize}

As seis primeiras derivações, I, II, III, aV\textsubscript{R}, aV\textsubscript{L} e aV\textsubscript{F} são derivadas dos mesmos três pontos de medição. Por isso, qualquer par dentre este grupo fornece a mesma informações que os quarto restantes \cite{MALMIVUO1995}. A localização das derivações é ilustrada na figura ~\ref{fig:leads}.

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.6\textwidth]{./figs/leads.png} % <- formatos PNG, JPG e PDF
		\caption[Derivações cardíacas]{Derivações cardíacas}
	\fonte{\cite{MALMIVUO1995}}
	\label{fig:leads}
\end{figure}

Mais de 90\% da atividade elétrica cardíaca pode ser explicada com a medição de três componentes independentes. A princípio, duas das derivações límbicas I II III devem ser suficiente para descrever completamente o vetor elétrico cardíaco. A principal razão para que sejam gravadas as 12 derivações é porque enriquece o reconhecimento dos padrões. Esta combinação de derivações fornece ao medico a oportunidade de observar diversas projeções do vetor elétrico cardíaco, que consiste em um modo de visualizar o gerador de potencial elétrico do coração como um dipolo elétrico \cite{MALMIVUO1995}. 

\section{Ondas, Segmentos e Intervalos}
\label{sec:Ondas}

Além das ondas, os elementos existentes na forma de onda do Eletrocardiografia (ECG) são \cite{GACEK2011}:

\begin{itemize}
	\item Linha isoelétrica: a linha horizontal quando não há atividade elétrica no ECG;
	\item Segmentos: a duração da linha isoelétrica entre as ondas;
	\item Intervalos: o tempo entre dois segmentos de ondas adjacentes.
\end{itemize}

A onda P é a primeira deflexão do ECG ocorre durante a despolarização ventricular. É positiva na maioria das derivações, mesmo sendo pouco evidente. Sua amplitude não excede 0,15 mV e 0,25 mV nas derivações precordiais, e dura no máximo 0,12 segundos \cite{GACEK2011}.

A onda T, por sua vez, representa a repolarização ventricular, a restauração do repouso no potencial da membrana. As ondas T se diferenciam das ondas P, por seguirem o complexo QRS após cerca de 0,2 segundos. Após a onda T, ocorre a onda U, com a mesma polaridade da onda T que a precede. Ondas U invertidas podem aparecer na presença de hipertrofia do ventrículo esquerdo ou isquemia \cite{GACEK2011}.

O segmento PQ expressa tempo decorrido entre a despolarização atrial e o começo da despolarização ventricular, durando entre 0,12 e 0,2 segundos. O intervalo ventricular ST-T coincide com a repolarização do músculo ventricular. O intervalo QT corresponde à duração do potencial de ação ventricular e da repolarização. O intervalo TP é o período em que os átrios e ventrículos estão na diástole. O intervalo RR corresponde um ciclo cardíaco e é utilizado para o cálculo da frequência cardíaca \cite{GACEK2011}.

A identificação do complexo QRS não apresenta grandes dificuldades, uma vez que possui forma de onda característica e amplitude dominante. Esta amplitude mede cerca de 1 mV em um coração normal, mas pode ser muito maior em uma hipertrofia ventricular. O complexo QRS é o maior grupo de ondas no ECG e corresponde à despolarização ventricular.  A primeira deflexão negativa é a onda Q. Seguida de uma deflexão positiva, a onda R, sendo finalizada com uma última deflexão negativa denominada de onda S, completando um complexo QRS \cite{GACEK2011}.

A duração normal do QRS fica entre 0,08 e 0,09 segundos. Durações maiores são geralmente devidas à despolarização assíncrona dos dois ventrículos. Isto ocorre em casos de bloqueio atrioventricular de primeiro grau, síndromes de pré-excitação ou contração ventricular prematura. Nestas situações, um ventrículo é despolarizado mais cedo que o outro, fazendo com que o complexo QRS apresente uma onda R seguida de outra onda R. Estas ondas correspondem à despolarização dos dois ventrículos \cite{GACEK2011}. A figura ~\ref{fig:QRS} mostra as formas de onda características de um ciclo cardíaco.

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.8\textwidth]{./figs/QRS.png} % <- formatos PNG, JPG e PDF
		\caption[Ondas, segmentos e intervalos dos sinais de ECG]{Ondas, segmentos e intervalos dos sinais de ECG}
	\fonte{\cite{GACEK2011}}
	\label{fig:QRS}
\end{figure}

\section{Função Correlação}
\label{sec:Correl}

O conceito de correlação surgiu na antiguidade onde se comparavam padrões fazendo-os deslizar um sobre o outro. E é deste modo que funciona a correlação. A função correlação permite detectar a presença de um sinal conhecido no ruído. Entre alguns exemplos de aplicação, é possível detectar a presença de um rosto em uma multidão, comparar impressões digitais ou padrões de vasos sanguíneos da retina para identificar pessoas, e determinar que arma disparou um projétil mesmo que ele esteja amassado ou parcialmente derretido. É utilizada também em radares, no sistema  \sigla{GPS}{\textit{Global Positioning System}} e na análise de \sigla{DNA}{\textit{Deoxyribonucleic Acid}} \cite{bloch2004l}. 

A função correlação cruzada é utiliza dois conjuntos de dados, e calcula uma medida da semelhança entre eles. Podem ser utilizados um sinal recebido e um padrão armazenado. À medida que o padrão se desloca pelo sinal recebido, o produto de superposição é calculado e plotado para cada deslocamento. Quando atinge seu valor máximo, 1, há uma coincidência perfeita \cite{bloch2004l}. Um exemplo de aplicação da função correlação é ilustrada na figura ~\ref{fig:corre}.

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.9\textwidth]{./figs/corre.png} 
		\caption[Exemplo de aplicação da função correlação]{Exemplo de aplicação da função correlação}
	\fonte{Modificado de \cite{smith}}
	\label{fig:corre}
\end{figure}

No domínio discreto de dados a função correlação pode ser calculada na equação ~(\ref{eq:correlacao}), em que o índice \textit{r} refere-se ao sinal recebido e o índice \textit{a} se refere ao padrão armazenado. O fator de normalização \textit{K} é igual à soma dos quadrados dos valores do padrão armazenado \cite{bloch2004l}.

\begin{equation}
 R_{r,a} (\tau )= \frac{1}{K}\sum_{n=0}^{N-1} f_{r}(n)f_{s}(\tau + n)
\label{eq:correlacao}
\end{equation}

O padrão de sinal armazenado para comparação pode não ser realmente ao sinal que se pretende identificar, pode ser uma estimativa do sinal original, ou uma réplica. Pode ser utilizado um conjunto de padrões de sinais similares ao que se deseja buscar. É com base neste tipo de estimativas que operam astrônomos, peritos em criptografia e especialistas em supervisão eletrônica \cite{bloch2004l}.

\section{Redes Neurais Artificiais}
\label{sec:RNA}

O cérebro humano funciona de modo completamente diferente dos computadores digitais convencionais. O cérebro pode ser considerado como um computador extremamente complexo, não linear que apresenta paralelismo. As unidades básicas que constituem o cérebro, chamadas neurônios, têm a capacidade de organizarem-se para desempenhar tarefas tais como reconhecimento de padrões, percepção e controle motor \cite{HAYKIN2011}.

De certa forma, as redes neurais artificiais foram criadas para realizar atividades mimetizando o cérebro humano. As redes neurais artificiais são modelos matemáticos que podem ser implementadas com componentes eletrônicos ou simuladas em software \cite{HAYKIN2011}.

As unidades básicas de processamento de uma rede neural artificial são chamadas de neurônios, analogamente ao cérebro humano. Os neurônios formam entre si grandes conexões caracterizadas por pesos sinápticos \cite{HAYKIN2011}. 

As redes neurais artificiais passam por um processo de aprendizado, também conhecido como algoritmo de aprendizado. Neste processo, são modificados os pesos sinápticos dos neurônios de maneira ordenada visando alcançar um determinado estado objetivo \cite{HAYKIN2011}.

Um sinal \textit{x\textsubscript{j}} na entrada da sinapse \textit{j} conectada ao neurônio \textit{k}, é multiplicada pelo peso sináptico \textit{w\textsubscript{kj}}. Constitui também a rede neural artificial um somador, para somar os sinais da entrada ponderados pelas respectivas conexões do neurônio (estas operações constituem uma combinação linear). Uma função de ativação é empregada para limitar a amplitude da saída de um neurônio a um determinado intervalo numérico, usualmente este intervalo corresponde a [0,1] ou [-1,1]. A figura ~\ref{fig:RN2} ilustra a estrutura básica de uma rede neural artificial \cite{HAYKIN2011}.

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.6\textwidth]{./figs/RN2.png} 
		\caption[Estrutura de uma rede neural artificial]{Estrutura de uma rede neural artificial}
	\fonte{\cite{HAYKIN2011}}
	\label{fig:RN2}
\end{figure}

A função de ativação que limita a saída de um neurônio pode ser de três tipos básicos:

\begin{itemize}
	\item Função de limiar ou \textit{threshold};
	\item Função \textit{Piecewise}~-- contínua;
	\item Função Sigmóide.
\end{itemize}

A figura ~\ref{fig:limiares} representa os gráficos dos três tipos de função de ativação.

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.5\textwidth]{./figs/limiares.png} 
		\caption[Gráficos das funções de ativação]{Gráficos das funções de ativação}
	\fonte{\cite{HAYKIN2011}}
	\label{fig:limiares}
\end{figure}

\subsection{Rede Multicamadas}

Dentre os tipos de redes neurais artificiais existentes, cabe destacar as redes Perceptron Multicamadas (\textit{Multilayer Perceptron} ~-- \sigla{MLP}{\textit{Multilayer Perceptron}}). Estas redes são formadas por uma camada de entrada, uma ou mais camadas de nós intermediárias escondidas e um camada de nós de saída. A figura ~\ref{fig:RN4} mostra a estrutura de uma rede neural com múltiplas camadas \cite{HAYKIN2011}.

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.9\textwidth]{./figs/RN4.png} 
		\caption[Rede neural do tipo Multilayer Perceptron]{Rede neural do tipo Multilayer Perceptron}
	\fonte{\cite{HAYKIN2011}}
	\label{fig:RN4}
\end{figure}

Como mencionado anteriormente, os neurônios formam conexões representadas pelos pesos sinápticos e ao processo de modificação destes pesos dá-se o nome de algoritmo de aprendizado. As redes Perceptron multicamadas podem ser treinadas por meio do algoritmo de aprendizado \textit{backpropagation}. Em termos gerais, um sinal de erro é originado na saída da rede, e propagado de frente para trás \textit{(backwards)} de camada em camada, relacionando os dados de entrada e saída \cite{HAYKIN2011}.

\subsection{Estratégia de Treinamento para Rede Multicamadas}

A rede multicamadas é treinada com o algoritmo \textit{backpropagation}, em estágios, produzindo funções de mapeamento complexas. Observa-se que o erro médio quadrado diminui com o aumento do número de épocas durante um treinamento. No início apresenta um valor elevado, diminui rapidamente, e então começa a diminuir lentamente até o valor do mínimo local na superfície de erro \cite{HAYKIN2011}. A figura \ref{parada} mostra a relação entre o erro médio quadrado e as épocas de treinamento.

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.5\textwidth]{./figs/parada3.png} 
		\caption[Relação entre o erro médio quadrado e treinamento]{Relação entre o erro médio quadrado e treinamento}
	\fonte{Modificado de \cite{HAYKIN2011}}
	\label{parada}
\end{figure}

É possível, portanto, acabar treinando a rede em excesso, se o treinamento não for interrompido no instante certo. Para identificar este instante, a cada período de treinamento, a rede é testada e o erro médio quadrado monitorado. A este procedimento dá-se o nome de método de treinamento de parada antecipada. O menor erro médio indica qual a melhor época de treinamento, com base nos testes \cite{HAYKIN2011}.

\subsection{Validação Cruzada}

Partindo do princípio de que as redes neurais artificiais do tipo MLP passam por um processo de treinamento, é necessário um conjunto de dados para a realização desta etapa. Além disso é necessário testar o funcionamento da rede. Considerada uma padrão pela estatística, a validação cruzada soluciona esta questão ao dividir a base de dados inicial em dois conjuntos \cite{HAYKIN2011}. São eles:

\begin{itemize}
	\item Conjunto de dados de treinamento;
	\item Conjunto de dados de testes.
\end{itemize}

Além destas duas divisões, o conjunto de dados de treinamento pode ser dividido em dados para estimativa e dados para validação \cite{HAYKIN2011}. Contudo, o estudo aprofundado deste tema não faz parte do escopo deste projeto.

\subsection{Redes Neurais de Kohonen}

Existe um tipo especial de redes neurais artificiais auto organizáveis conhecidas como Mapas Auto Organizáveis ou Mapas de Kohonen. Nos Mapas de Kohonen, os neurônios, ou nós, são dispostos em nós em uma estrutura bidimensional e passam por um processo de aprendizado competitivo utilizando padrões de entrada.  Os neurônios ficam então ordenados em relação a uns aos outros. O Mapa de Kohonen forma, portanto, um mapa topográfico dos padrões de entrada, no qual as coordenadas dos neurônios indicam características dos padrões de entrada \cite{HAYKIN2011}.

Cabe explicitar que o aprendizado dos Mapas de Kohonen é do tipo não supervisionado, isso significa que não é necessário um conjunto de dados de treinamento para que a rede aprenda a classificar padrões \cite{Guthi}.

No mapa, cada nó é conectado a todos os nós de entrada, mas não são conectados entre si, como ilustra a figura \ref{fig:map0}. Cada nó possui um vetor de pesos, e também uma coordenada única \textit{(i,j)}. Esta coordenada auxilia a identificar o nó, além de ser importante para os cálculos do algoritmo do Mapa de Kohonen \cite{Guthi}. 

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.4\textwidth]{./figs/map1.png} 
		\caption[Estrutura de um Mapa de Kohonen]{Estrutura de um Mapa de Kohonen}
	\fonte{\cite{Guthi}}
	\label{fig:map0}
\end{figure}

As redes devem ser formadas por nós, sendo que cada um deles deverá possuir um vetor de pesos de dimensão n. Para que o algoritmo funcione adequadamente, os nós de entrada também deverão apresentar vetores de entrada com dimensão n. E, considerando que os neurônios não possuem nenhuma conexão com os neurônios em sua vizinhança, não podem conhecer o valor dos pesos deles. Para serem organizados, os dados passam pelo algortimo do Mapa de Kohonen. Este algoritmo que agrupa os padrões de entrada é descrito a seguir \cite{Guthi}.

\begin{enumerate}
	\item Os pesos de cada nó são inicializados;
	\item Um vetor é escolhido \textit{(input vector)} aleatoriamente dos dados de entrada e apresentado a rede;
	\item Cada nó da rede é analisado em busca do nó que apresenta pesos mais similares ao nó escolhido \textit{(input vector)}. Este nó é conhecido como \textit{Best Matching Unit} (BMU). O BMU é encontrado com o cálculo da distância dado pela equação ~(\ref{eq:bmu}), em que \textit{I} se refere ao vetor escolhido, \textit{W} ao vetor de pesos do nó e \textit{n} à dimensão do vetor. 
	
	\begin{equation}
	 DistFromInput^{2} = \sum_{i=n}^{i=0}(I_{i} - W_{i})^{2}
	\label{eq:bmu}
	\end{equation}
	
	\item Calcula-se o raio da vizinhança do BMU de acordo com a equação ~(\ref{eq:raio}). Este valor deve ser inicialmente grande, mas diminui a cada iteração do algoritmo. Os termos da equação \textit{t}, $\sigma$\textsubscript{0} e $\lambda$ correspondem a iteração atual, número de iterações sobre o raio do mapa e raio do mapa, respectivamente.
	
	\begin{equation}
	\sigma (t) = \sigma _{0}e^{(-t/\lambda))}
	\label{eq:raio}
	\end{equation}
		
	\item Os nós encontrados dentro do raio do \sigla{BMU}{\textit{Best Matching Unit}} tem seus pesos alterados de modo a se assemelharem aos pesos do BMU, conforme as equações (\ref{p1}), (\ref{p2}) e (\ref{p3}).
	
	\begin{equation}
	W(t+1) = W(t) + \Theta(t)L(t)(I(t) - W(t))
	\label{p1}
	\end{equation}
	
	\begin{equation}
	L(t) = L_{0}e^{(-t/\lambda)}
	\label{p2}
	\end{equation}
		
	\begin{equation}
	\Theta = e^{(-DistFromBMU^{2}/2\sigma ^{2}(t))}
	\label{p3}
	\end{equation}
		
	\item Repetir o passo 2 por N iterações.
\end{enumerate}

Um exemplo clássico de implementação de Mapas de Kohonen é a clusterização de cores. A figura \ref{fig:color1} mostra uma rede inicializada com um conjunto de dados. Cada pixel é um nó da rede e os vetores de peso são representados pela tripla (R,G,B), que caracteriza a cor do nó.

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.4\textwidth]{./figs/color1.png} 
		\caption[Mapa de Kohonen inicializado]{Mapa de Kohonen inicializado}
	\fonte{\cite{Guthi}}
	\label{fig:color1}
\end{figure}

A aplicação do algoritmo do Mapa de Kohonen descrito anteriormente deve resultar no mapa mostrado pela figura \ref{fig:color2}. Percebe-se que as cores foram agrupadas de acordo com a semelhança entre elas.

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.4\textwidth]{./figs/color2.png} 
		\caption[Mapa de Kohonen após algoritmo]{Mapa de Kohonen após algoritmo}
	\fonte{\cite{Guthi}}
	\label{fig:color2}
\end{figure}

\section{Avaliação de Sistemas Classificadores}
\label{sec:AvaliaSis}

Nesta seção vamos nos concentrar em formas de avaliar o desempenho de sistemas classificadores por meio das seções: Tabela de Contingência \ref{subsec:TabelaCont}, Sensibilidade e Especificidade \ref{subsec:SeEsP}, Curva ROC \ref{subsec:ROCCurva} e Outros Índices Estatísticos \ref{subsec:outros}.

\subsection{Tabela de Contingência}
\label{subsec:TabelaCont}

A tabela de contingência, também chamada de tabela de confusão, é descrita como uma ferramenta capaz de representar, dentro de uma população, os indivíduos doentes, indivíduos sadios, indivíduos com teste positivo e indivíduos com teste negativo \cite{massad2004}, como mostrado na tabela~\ref{tab:confusao}.

\begin{table}[!htb]
	\centering
	\caption[Tabela de Contingência 2x2]{Tabela de Contingência 2x2}
	\label{tab:confusao}	
		\centering
		\includegraphics[width=1\textwidth]{./figs/tab.png} % <- formatos PNG, JPG e PDF
	\fonte{\cite{SOVIERZOSKI2009}}
\end{table}

A partir da tabela de contingência, podem ser observados os seguintes índices: 
\begin{itemize}
	\item \sigla{VP}{Verdadeiro Positivo} (Verdadeiro positivo): doente com resultado positivo;  
	\item \sigla{FP}{Falso positivo} (Falso positivo): sadio com resultado positivo;
	\item \sigla{FN}{Falso negativo} (Falso negativo): doente com resultado negativo; 
	\item \sigla{VN}{Verdadeiro negativo} (Verdadeiro negativo): sadio com resultado negativo.
\end{itemize}

Como este projeto pretende obter a identificação do complexo QRS em exames de Eletrocardiografia (ECG), a etapa de testes trata como verdadeiro positivo o complexo QRS indicado como positivo, falso positivo como padrão diferente do complexo QRS indicado como positivo, falso negativo como um complexo QRS não identificado e verdadeiro negativo como um padrão diferente do complexo QRS não identificado pelo sistema \cite{SARAIVA2012}. A lógica desta avaliação é expressa pela figura ~\ref{fig:TesteDiag}.

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.7\textwidth]{./figs/TesteDiag.png} % <- formatos PNG, JPG e PDF
		\caption[Exemplo de sinal e padrão de classificação]{Exemplo de sinal e padrão de classificação considerando o nível de decisão}
	\fonte{\cite{SARAIVA2012}}
	\label{fig:TesteDiag}
\end{figure}

Os índices da tabela de contingência são utilizados para o cálculo de outros índices, tais como sensibilidade, especificidade, eficiência e o índice DER.

\subsection{Sensibilidade e Especificidade}
\label{subsec:SeEsP}

A sensibilidade pode ser descrita como a medida da capacidade de um sistema em identificar indivíduos com exame positivo entre os indivíduos verdadeiramente doentes, levando em conta outros indivíduos doentes com exames negativos, como evidencia a equação ~(\ref{eq:sensibilidade}). Logo, quanto maior a sensibilidade de um sistema, menor o número de falsos negativos \cite{massad2004}.

\begin{equation}
sensibilidade = \frac{VP}{VP + FN}
\label{eq:sensibilidade}
\end{equation}

Especificidade mede a capacidade do sistema em identificar os indivíduos negativos entre os verdadeiramente não doentes, representada pela equação ~(\ref{eq:especificidade}). Assim, quanto menor o número de falsos positivos identificados pelo sistema, maior será sua especificidade \cite{massad2004}.

\begin{equation}
especificidade = \frac{VN}{VN + FP}
\label{eq:especificidade}
\end{equation}

A sensibilidade e especificidade costumam retornar diferentes valores de acordo com a variação em algum atributo do sistema, geralmente o limiar de decisão da rede neural \cite{SOVIERZOSKI2009}. A figura ~\ref{fig:SensibEspec} mostra o comportamento dos índices de sensibilidade e especificidade em função do limiar de decisão de uma rede neural do tipo Perceptron Multicamadas (\textit{Multilayer Perceptron} ~-- \sigla{MLP}{\textit{Multilayer Perceptron}}).

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.6\textwidth]{./figs/SensibEspec.png} % <- formatos PNG, JPG e PDF
		\caption[Gráficos de Sensibilidade e Especificidade]{Gráficos de Sensibilidade e Especificidade}
	\fonte{\cite{SARAIVA2012}}
	\label{fig:SensibEspec}
\end{figure}

\subsection{Curva ROC}
\label{subsec:ROCCurva}

A Curva \sigla{ROC}{\textit{Receiving Operating Characteristic}} \textit{(Receiving Operating Characteristic)} é útil para visualização da performance de classificadores. Seu uso vem crescendo em pesquisas nas áreas de \textit{machine learning} e \textit{data mining} \cite{FAWCETT2006}. 

Os valores de sensibilidade e especificidade são organizados em pares ordenados, e dispostos no primeiro quadrante de um plano cartesiano. Com algum método de interpolação, são interligados desde a origem (sensibilidade = 0 e especificidade = 1), até o extremo oposto do gráfico (sensibilidade = 1 e especificidade = 0), dando origem a curva ROC \cite{massad2004}, conforme ilustra a figura ~\ref{fig:ROC}. 

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.4\textwidth]{./figs/ROC.png} 
		\caption[Curva ROC]{Curva ROC}
	\fonte{\cite{SOVIERZOSKI2009}} 
	\label{fig:ROC}
\end{figure}

Cada ponto da curva ROC equivale a um valor diferente do limiar de decisão da rede neural, dessa forma, construindo a relação entre sensibilidade e especificidade \cite{SOVIERZOSKI2009}.

No eixo das ordenadas da curva ROC pode ser observada a fração dos verdadeiros positivos (sensibilidade). E no eixo das abcissas, a fração dos falsos positivos, correspondente ao complemento da especificidade (1 - especificidade) \cite{massad2004}.

A linha tracejada representa um sistema classificador incapaz de discriminar, em outras palavras, um sistema que apresenta o mesmo percentual de verdadeiros positivos e de falsos positivos. Quanto mais afastada da linha tracejada estiver a curva ROC (de modo semelhante à figura ~\ref{fig:ROC}), melhor é o desempenho do sistema. O classificador ideal possui sensibilidade = 1 e especificidade = 1 \cite{Brown2006}. 
 
 
\subsection{Outros Índices Estatísticos}
\label{subsec:outros}

Além de inúmeros outros métodos para medição do desempenho de sistemas classificadores, existem o índice DER e eficiência. 

O índice \sigla{DER}{\textit{Detection Error Rate}} \textit{(Detection Error Rate)}, dado na equação (\ref{eq:DER}) \cite{Zhang2007}, relaciona o número de erros do sistema, soma dos falsos positivos e falsos negativos, com o número total de eventos do sistema.

\begin{equation}
DER = \frac{FP +FN}{\textrm{Total de eventos QRS}}
\label{eq:DER}
\end{equation}

Eficiência ou \textit{accuracy} corresponde a capacidade de um sistema em identificar os verdadeiros doentes e sadios \cite{SOVIERZOSKI2009}. A fórmula para o cálculo da eficiência é dada na equação ~(\ref{eq:accuracy}).

\begin{equation}
accuracy = \frac{VP + VN}{VP + VN + FP + FN}
\label{eq:accuracy}
\end{equation}

\section{Considerações}
\label{sec:Consid}

O capítulo de Fundamentação Teórica forneceu esclarecimento acerca de diversos conhecimentos necessários durante implementação do projeto. Entre eles, cabe destacar os conceitos abordados pelas seções Função Correlação \ref{sec:Correl}, Redes Neurais Artificiais \ref{sec:RNA} e Avaliação de Sistemas Classificadores \ref{sec:AvaliaSis}. O entendimento destes conceitos em particular é essencial para uma leitura proveitosa dos próximos capítulos desta monografia.

O próximo capítulo, Materiais e Métodos \ref{sec:Materiais}, explica a maneira como todos estes conhecimentos foram aplicados de modo prático, e também os recursos utilizados ao longo do desenvolvimento deste projeto.
